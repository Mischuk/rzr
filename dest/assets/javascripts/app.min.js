$(function() {
    $('a[href="#"]').click(function(e){ e.preventDefault(); });

    function selectric() {
      $('select').selectric({
        maxHeight: 200,
        disableOnMobile: false,

      });
      $('select').on('selectric-change', function(element){
        var thisValue = $(this).val();
        console.log(thisValue);

        if ( thisValue == null ) {
          console.log('null')
        } else {
          var data = $(this).data('selectric');
          $(data.element).parents('.input').removeClass('required error');
        }
      });
    };
    selectric();

    function inputMask() {
      $(".mask-date").mask("99.99.9999",{placeholder:"__.__.____"});
      $(".mask-year").mask("9999",{placeholder:""});
      $(".mask-tel").mask("+7 (999) 999-99-99");
    };
    inputMask();

    $("#lightgallery").lightGallery({
      selector: '.item a'
    });

    FastClick.attach(document.body);

    $('.popup-with-zoom-anim').magnificPopup({
      type: 'inline',
      fixedContentPos: false,
      fixedBgPos: true,
      overflowY: 'auto',
      closeBtnInside: true,
      preloader: false,
      midClick: true,
      removalDelay: 300,
      mainClass: 'my-mfp-zoom-in'
    });
    $('.login-modal').on('click', function(){
        $('.popup-with-zoom-anim').magnificPopup('close');
        setTimeout(function(){
          $('#second-step').trigger('click');
        }, 300);
    });
    $('#auth-form').on('submit', function(e){
        $('.popup-with-zoom-anim').magnificPopup('close');
        setTimeout(function(){
          $('#third-step').trigger('click');
        }, 300);
        e.preventDefault();
    });

    $('.close-modal').on('click', function(){
      $('.popup-with-zoom-anim').magnificPopup('close');
    });


    function stepsForm() {


      var $next = $('.control-next');


      var $prev = $('.control-prev');


      var $form = $('.steps-form');


    


      $form.find('input').on('blur', function(){


        if ( $(this).val() == "" ) {


          $(this).parent().addClass('required');


        } else {


          $(this).parent().removeClass('required error');


        }


      });


    


      $form.find('input').on('focus', function(){


        $(this).parent().removeClass('error');


      });


    


      $prev.on('click', function(){


        var eqGroups = $form.find('.form-group').length;


    


        $form.find('.form-group.current').removeClass('current').prev().addClass('current');


        var currentGroup = $form.find('.form-group.current').index();


        console.log(currentGroup);


        if ( currentGroup > 1 && currentGroup < 4 )  {


          $('.control-next').removeClass('hidden');


          $('.submit').addClass('hidden');


        } else if ( currentGroup == 4 ) {


          $('.control-next').addClass('hidden');


          $('.submit').removeClass('hidden');


        }


    


        if ( currentGroup > 1 )  {


          $('.control-prev').removeClass('hidden');


        } else if ( currentGroup == 1 ) {


          $('.control-prev').addClass('hidden');


        }


      });


    


      $next.on('click', function(){


        var required = $form.find('.form-group.current .input.required').length;


        var eqGroups = $form.find('.form-group').length;


    


        if ( required == 0 ) {


          var currentGroup = $form.find('.form-group.current').next().index();


          $form.find('.form-group.current').removeClass('current').next().addClass('current');


          $('.required').removeClass('error');


          if ( currentGroup > 1 && currentGroup < 4 )  {


            $('.control-next').removeClass('hidden');


            $('.submit').addClass('hidden');


          } else if ( currentGroup == 4 ) {


            $('.control-next').addClass('hidden');


            $('.submit').removeClass('hidden');


          }


    


          if ( currentGroup > 1 )  {


            $('.control-prev').removeClass('hidden');


          } else if ( currentGroup == 1 ) {


            $('.control-prev').addClass('hidden');


          }


          return false;


        } else {


          $form.find('.form-group.current').find('.input').each(function(){


            if ( $(this).hasClass('required') ){


              $(this).addClass('error');


            }


          });


          return false;


        }


      });


    };


    stepsForm();


    


    function equalItem() {


      var item = $('.list-images#lightgallery .item');


      var W = item.width();


      item.height(W);


    };


    


    $(window).load(equalItem);


    $(window).resize(equalItem);


    


    function mobileMenu() {


      $('.mobile-menu-trigger').on('click', function(){


        $(this).toggleClass('open');


        $('.background-layout').toggleClass('show');


        $('.menu').toggleClass('open');


      });


    


      $('.background-layout').on('click', function(){


        $('.mobile-menu-trigger, .menu').removeClass('open');


        $(this).removeClass('show');


      });


    };


    mobileMenu();


    


    function equalImage() {


      var mitem = $('.m_item .image');


      var W = mitem.width();


      mitem.height(W-(W-((W/4)*3)));


    };


    


    $(window).load(equalImage);


    $(window).resize(equalImage);


    


    function equalsImage() {


      var mitem = $('.m_gallery .group .item');


      var W = mitem.width();


      mitem.height(W-(W-((W/4)*3)));


    };


    


    $(window).load(equalsImage);


    $(window).resize(equalsImage);


    


    


    function equalszImage() {


      var mitem = $('.m_gallery .list-video .item a .image');


      var W = mitem.width();


      mitem.height(W-(W-((W/4)*3)));


    };


    


    $(window).load(equalszImage);


    $(window).resize(equalszImage);


    


    


    


    


    function leadCarouselHeight() {


        var WH = $(window).height();


        var HEADER = $('.m_header').height();


        $('.m_lead-carousel').height(WH - HEADER);


    };


    leadCarouselHeight();


    


    function leadCarousel() {


      $('.lead-carousel').slick({


        dots: false,


        arrows: true,


        fade: false,


        speed: 500,


        autoplay: true,


        autoplaySpeed: 7000,


        cssEase: 'ease-out',


        pauseOnHover: false


      });


    };


    leadCarousel();


    
});